generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id       String   @id @default(uuid())
  email    String   @unique @db.VarChar(150)
  password String   @db.VarChar(255)
  role     UserRole @default(USER)

  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
  transactions Transaction[]
}

model Transaction {
  id     String @id @default(uuid())
  user   User   @relation(fields: [userId], references: [id], onUpdate: Cascade, onDelete: Cascade)
  userId String

  type       TransactionType     @default(EXPENSE)
  amount     Float
  currency   String              @default("IRR") @db.Char(4)
  category   TransactionCategory @default(OTHER)
  intent     TransactionIntent // Enum: Planned, Impulse, Obligation
  emotion    TransactionEmotion // Enum: Regret, Satisfaction, etc.
  note       String?             @db.VarChar(500) // Reflection or short explanation
  occurredAt DateTime            @default(now())

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([userId, occurredAt])
}

enum UserRole {
  USER
  ADMIN
}

enum TransactionType {
  INCOME
  EXPENSE
}

enum TransactionCategory {
  DAILY_EXPENSES
  TRANSFERS
  SALARY
  FOOD_AND_DRINKS
  CASH
  HEALTH_AND_BEAUTY
  UTILITIES
  CLOTHING
  TRANSPORTATION
  HOUSING
  ENTERTAINMENT
  ART_AND_CULTURE
  SAVINGS_AND_INVESTMENTS
  SPORTS
  GIFTS_AND_DONATIONS
  LOAN_PAYMENTS
  OTHER
}

enum TransactionEmotion {
  REGRET
  SATISFACTION
  STRESS
  NEUTRAL
  GUILT
  RELIEF
}

enum TransactionIntent {
  PLANNED
  IMPULSIVE
  MANDATORY
}
